{# 
  Этот файл отвечает за отображение ОДНОГО поля (строки) в Simple.
  Мы убираем стандартные классы OpenCart/Bootstrap (form-group, col-sm-*)
  и добавляем свой класс .cart_inp для стилизации, как в cart.html.
  Оборачиваем каждое поле в простой div.
  Используем placeholder вместо label. Если placeholder не задан в админке,
  используем label (название поля), очищенный от HTML-тегов.
#}
{% set placeholder_text = placeholder ? placeholder : label|striptags %}

<div class="simple-form-row {% if required %}required{% endif %}">
    
    {# Тип поля: выпадающий список. Здесь placeholder не используется, т.к. текст обычно в первом <option> #}
    {% if type == 'select' or type == 'select2' %}
        <select class="cart_inp" name="{{ name }}" id="{{ id }}" {{ bootstrap ? 'data-theme="bootstrap"' : '' }} {{ type == 'select2' ? 'data-type="select2"' : '' }} {{ reload ? 'data-onchange="reloadAll"' : ''}}>
            {% for info in values %}
                <option value="{{ info['id'] | escape }}" {{ value == info['id'] ? 'selected="selected"' : '' }}>{{ info['text'] }}</option>
            {% endfor %}
        </select>
        
    {# Тип поля: радио-кнопки. Имеют собственные метки. #}
    {% elseif type == 'radio' %}
        <div class="radio-group">
        {% for info in values %}
          <div class="radio">
            <label><input type="radio" name="{{ name }}" id="{{ id }}_{{ info['id'] }}" value="{{ info['id'] | escape }}" {{ value == info['id'] ? 'checked="checked"' : '' }} {{ reload ? 'data-onchange="reloadAll"' : '' }}>{{ info['text'] }}</label>
          </div>
        {% endfor %}
        </div>

    {# Тип поля: чекбоксы. Имеют собственные метки. #}
    {% elseif type == 'checkbox' %}
        <div class="checkbox-group">
        {% for info in values %}
          <div class="checkbox">
            <label><input type="checkbox" name="{{ name }}[]" id="{{ id }}_{{ info['id'] }}" value="{{ info['id'] | escape }}" {{ info['id'] in value ? 'checked="checked"' : '' }} {{ reload ? 'data-onchange="reloadAll"' : ''}}>{{ info['text'] }}</label>
          </div>
        {% endfor %}
        </div>

    {# Тип поля: переключатель #}
    {% elseif type == 'switcher' %}
        <div class="switcher-group">
          <div class="checkbox">
            <label><input type="checkbox" name="{{ name }}" id="{{ id }}" data-unchecked-value="0" value="1" {{ value == '1' ? 'checked="checked"' : '' }} {{ reload ? 'data-onchange="reloadAll"' : ''}}>{{ placeholder_text }}</label>
          </div>
        </div>

    {# Тип поля: многострочный текст #}
    {% elseif type == 'textarea' %}
        <textarea class="cart_inp" name="{{ name }}" id="{{ id }}" placeholder="{{ placeholder_text }}" {{ reload ? 'data-onchange="reloadAll"' : ''}}>{{ value }}</textarea>

    {# Тип поля: капча #}
    {% elseif type == 'captcha' %}
        {% if site_key %}
          {# Google reCAPTCHA #}
          <script src="https://www.google.com/recaptcha/api.js?hl={{ lang }}&onload=recaptchaInit&render=explicit" type="text/javascript" async defer></script>
          <input type="hidden" name="{{ name }}" id="{{ id }}" value="{{ value }}">
          <script type="text/javascript">
            function recaptchaCallback(value) {
              $('#{{ id }}').val(value).trigger('change');
            }
            function recaptchaInit(){
              grecaptcha.render('simple-recaptcha');
            }
          </script>
          <div id="simple-recaptcha" data-sitekey="{{ site_key }}" data-callback="recaptchaCallback"></div>
        {% else %}
          {# Обычная капча #}
          <input type="text" class="cart_inp" name="{{ name }}" id="{{ id }}" value="" placeholder="{{ placeholder_text }}" {{ reload ? 'data-onchange="reloadAll"' : ''}}>
          <div class="simple-captcha-container"><img src="index.php?{{ additional_path }}route=common/simple_connector/captcha&t={{ time }}" alt="" id="captcha" /></div>
        {% endif %}

    {# Тип поля: загрузка файла #}
    {% elseif type == 'file' %}
        <input type="button" value="{{ button_upload }}" data-file="{{ id }}" class="button cart_inp">
        <div id="text_{{ id }}" class="filename-text">{{ filename }}</div>
        <input type="hidden" name="{{ name }}" id="{{ id }}" value="{{ value }}">

    {# Типы полей: дата/время #}
    {% elseif type in ['date', 'time', 'datetime'] %}
        <div class="input-group-custom {{ type }}">
          <input class="cart_inp" type="text" data-type="{{ type }}" name="{{ name }}" id="{{ id }}" value="{{ value }}" placeholder="{{ placeholder_text }}" {{ attrs }} {{ reload ? 'data-onchange="reloadAll"' : ''}}>
          <span class="input-group-btn-custom">
            <button type="button" class="btn-custom-icon">
              {% if type == 'date' or type == 'datetime' %}<i class="fa fa-calendar"></i>{% else %}<i class="fa fa-clock-o"></i>{% endif %}
            </button>
          </span>
        </div>

    {# Все остальные типы полей (text, password, tel, email) #}
    {% else %}
        <input class="cart_inp" type="{{ type }}" name="{{ name }}" id="{{ id }}" {{ type == 'password' ? 'data-validate-on="keyup"' : '' }} value="{{ value }}" placeholder="{{ placeholder_text }}" {{ attrs }} {{ reload ? 'data-onchange="reloadAll"' : ''}}>
    {% endif %}

    {# Сообщения об ошибках валидации и подсказки. Их нужно сохранить, т.к. они важны для работы Simple. #}
    {% if rules is not empty %}
    <div class="simplecheckout-rule-group" data-for="{{ id }}">
        {% for rule in rules %}
        <div {{ rule['display'] and not rule['passed'] ? '' : 'style="display:none;"' }} data-for="{{ id }}" data-for-type="{{ type }}"  data-rule="{{ rule['id'] }}" class="simplecheckout-error-text simplecheckout-rule" {{ rule['attrs'] }}>{{ rule['text'] }}</div>
        {% endfor %}
    </div>
    {% endif %}
    
    {% if description %}
    <div class="simplecheckout-tooltip" data-for="{{ id }}">{{ description }}</div>
    {% endif %}

</div>
